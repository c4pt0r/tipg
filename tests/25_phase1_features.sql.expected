psql:tests/25_phase1_features.sql:7: NOTICE:  table "fetch_test" does not exist, skipping
DROP TABLE
CREATE TABLE
INSERT 0 7
 id | name  | score 
----+-------+-------
  1 | Alice |    95
(1 row)

 id | name  | score 
----+-------+-------
  1 | Alice |    95
(1 row)

 id |  name   | score 
----+---------+-------
  1 | Alice   |    95
  2 | Bob     |    87
  3 | Charlie |    92
(3 rows)

 id |  name   | score 
----+---------+-------
  1 | Alice   |    95
  2 | Bob     |    87
  3 | Charlie |    92
(3 rows)

 id |  name   | score 
----+---------+-------
  3 | Charlie |    92
  4 | David   |    78
(2 rows)

 id | name  | score 
----+-------+-------
  6 | Frank |    91
  7 | Grace |    85
(2 rows)

 id | name  | score 
----+-------+-------
  1 | Alice |    95
  2 | Bob   |    87
(2 rows)

 id |  name   | score 
----+---------+-------
  1 | Alice   |    95
  3 | Charlie |    92
  6 | Frank   |    91
(3 rows)

 name | score 
------+-------
 Bob  |    87
 Eve  |    88
(2 rows)

DROP TABLE
psql:tests/25_phase1_features.sql:28: NOTICE:  table "departments" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:29: NOTICE:  table "employees_nj" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:30: NOTICE:  table "projects" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:31: NOTICE:  table "skills" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:32: NOTICE:  table "emp_skills" does not exist, skipping
DROP TABLE
CREATE TABLE
CREATE TABLE
INSERT 0 4
INSERT 0 5
 dept_id | emp_id |  name   | salary |  dept_name  |  location  
---------+--------+---------+--------+-------------+------------
       1 |    101 | Alice   |  75000 | Engineering | Building A
       2 |    102 | Bob     |  65000 | Sales       | Building B
       1 |    103 | Charlie |  80000 | Engineering | Building A
       3 |    105 | Eve     |  60000 | HR          | Building C
(4 rows)

 emp_id |  name   |  dept_name  |  location  
--------+---------+-------------+------------
    101 | Alice   | Engineering | Building A
    102 | Bob     | Sales       | Building B
    103 | Charlie | Engineering | Building A
    105 | Eve     | HR          | Building C
(4 rows)

  name   |  dept_name  
---------+-------------
 Alice   | Engineering
 Charlie | Engineering
(2 rows)

 dept_id | emp_id |  name   | salary |  dept_name  |  location  
---------+--------+---------+--------+-------------+------------
       1 |    101 | Alice   |  75000 | Engineering | Building A
       1 |    103 | Charlie |  80000 | Engineering | Building A
(2 rows)

 name  |  location  
-------+------------
 Alice | Building A
 Bob   | Building B
 Eve   | Building C
(3 rows)

  dept_name  | emp_count |     avg_salary     
-------------+-----------+--------------------
 Engineering |         2 | 77500.000000000000
 HR          |         1 | 60000.000000000000
 Sales       |         1 | 65000.000000000000
(3 rows)

  dept_name  | max_sal 
-------------+---------
 Engineering |   80000
(1 row)

CREATE TABLE
INSERT 0 3
  dept_name  |   proj_name   
-------------+---------------
 Engineering | Project Alpha
 Engineering | Project Gamma
 Sales       | Project Beta
(3 rows)

 emp_id |  name   |  dept_name  
--------+---------+-------------
    103 | Charlie | Engineering
    101 | Alice   | Engineering
    102 | Bob     | Sales
(3 rows)

 dept_id | emp_id |  name   | salary |  dept_name  |  location  
---------+--------+---------+--------+-------------+------------
       2 |    102 | Bob     |  65000 | Sales       | Building B
       1 |    103 | Charlie |  80000 | Engineering | Building A
(2 rows)

 matched_count 
---------------
             4
(1 row)

 total_employees 
-----------------
               5
(1 row)

CREATE TABLE
INSERT 0 4
  dept_name  | skill_name 
-------------+------------
 Engineering | Java
 Engineering | Python
 HR          | Excel
 Sales       | Sales
(4 rows)

DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
psql:tests/25_phase1_features.sql:82: NOTICE:  table "colors" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:83: NOTICE:  table "sizes" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:84: NOTICE:  table "materials" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:85: NOTICE:  table "numbers_a" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:86: NOTICE:  table "numbers_b" does not exist, skipping
DROP TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
INSERT 0 3
INSERT 0 4
INSERT 0 2
 color | size 
-------+------
 Blue  | L
 Blue  | M
 Blue  | S
 Blue  | XL
 Green | L
 Green | M
 Green | S
 Green | XL
 Red   | L
 Red   | M
 Red   | S
 Red   | XL
(12 rows)

 combinations 
--------------
           12
(1 row)

 color | size | material  
-------+------+-----------
 Red   | S    | Cotton
 Red   | M    | Cotton
 Red   | S    | Polyester
 Red   | M    | Polyester
(4 rows)

 total_combos 
--------------
           24
(1 row)

 color | size 
-------+------
 Red   | L
 Red   | M
 Red   | S
 Red   | XL
(4 rows)

 color | size 
-------+------
 Red   | S
 Blue  | M
 Green | L
(3 rows)

 color | size | material  
-------+------+-----------
 Blue  | M    | Cotton
 Blue  | M    | Polyester
 Blue  | S    | Cotton
 Blue  | S    | Polyester
 Red   | M    | Cotton
 Red   | M    | Polyester
 Red   | S    | Cotton
 Red   | S    | Polyester
(8 rows)

 color | size_count 
-------+------------
 Blue  |          4
 Green |          4
 Red   |          4
(3 rows)

 size | color_id_sum 
------+--------------
 L    |            6
 M    |            6
 S    |            6
 XL   |            6
(4 rows)

 color | size 
-------+------
 Blue  | L
 Blue  | M
 Blue  | S
 Blue  | XL
 Green | L
(5 rows)

 color | size 
-------+------
 Green | M
 Green | S
 Blue  | XL
(3 rows)

CREATE TABLE
INSERT 0 3
 a | b | product 
---+---+---------
 1 | 1 |       1
 1 | 2 |       2
 1 | 3 |       3
 2 | 1 |       2
 2 | 2 |       4
 2 | 3 |       6
 3 | 1 |       3
 3 | 2 |       6
 3 | 3 |       9
(9 rows)

 a | b 
---+---
 1 | 2
 1 | 3
 2 | 3
(3 rows)

CREATE TABLE
INSERT 0 1
 color | multiplier 
-------+------------
 Blue  |        100
 Green |        100
 Red   |        100
(3 rows)

 color | size 
-------+------
(0 rows)

DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
psql:tests/25_phase1_features.sql:140: NOTICE:  table "products_uf" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:141: NOTICE:  table "price_updates" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:142: NOTICE:  table "categories" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:143: NOTICE:  table "category_discounts" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:144: NOTICE:  table "inventory_levels" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:145: NOTICE:  table "stock_adjustments" does not exist, skipping
DROP TABLE
CREATE TABLE
CREATE TABLE
INSERT 0 5
INSERT 0 3
 id |  name  | price 
----+--------+-------
  1 | Apple  |   100
  2 | Banana |    50
  3 | Laptop |  1000
  4 | Phone  |   800
  5 | Book   |    25
(5 rows)

UPDATE 3
 id |  name  | price 
----+--------+-------
  1 | Apple  |   120
  2 | Banana |    50
  3 | Laptop |   950
  4 | Phone  |   800
  5 | Book   |    30
(5 rows)

CREATE TABLE
CREATE TABLE
INSERT 0 3
INSERT 0 2
UPDATE 4
 id |  name  | price | category_id 
----+--------+-------+-------------
  1 | Apple  |   108 |           1
  2 | Banana |    45 |           1
  3 | Laptop |   902 |           2
  4 | Phone  |   760 |           2
  5 | Book   |    30 |           3
(5 rows)

CREATE TABLE
INSERT 0 3
UPDATE 3
 id |  name  | price | stock 
----+--------+-------+-------
  1 | Apple  |   130 |    70
  2 | Banana |    55 |    90
  3 | Laptop |   902 |    10
  4 | Phone  |   750 |    30
  5 | Book   |    30 |   200
(5 rows)

UPDATE 0
 id |  name  | price 
----+--------+-------
  1 | Apple  |   130
  2 | Banana |    55
  3 | Laptop |   902
  4 | Phone  |   750
  5 | Book   |    30
(5 rows)

UPDATE 3
 id |  name  | price 
----+--------+-------
  1 | Apple  |   130
  2 | Banana |    55
  3 | Laptop |   902
  4 | Phone  |   750
  5 | Book   |    30
(5 rows)

UPDATE 2
 id |  name  | price | category_id 
----+--------+-------+-------------
  1 | Apple  |   140 |           1
  2 | Banana |    65 |           1
(2 rows)

 id | name | price 
----+------+-------
  5 | Book |    30
(1 row)

DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
psql:tests/25_phase1_features.sql:203: NOTICE:  table "source_data" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:204: NOTICE:  table "derived_table" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:205: NOTICE:  table "high_scores" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:206: NOTICE:  table "name_list" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:207: NOTICE:  table "agg_result" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:208: NOTICE:  table "join_result" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:209: NOTICE:  table "expr_result" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:210: NOTICE:  table "orders_ctas" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:211: NOTICE:  table "customers_ctas" does not exist, skipping
DROP TABLE
CREATE TABLE
INSERT 0 5
SELECT 4
 id |  name   
----+---------
  1 | Alice
  2 | Bob
  3 | Charlie
  5 | Eve
(4 rows)

SELECT 2
  name   | score | grade 
---------+-------+-------
 Alice   |    95 | A
 Charlie |    92 | A
(2 rows)

SELECT 3
 grade 
-------
 A
 B
 C
(3 rows)

psql:tests/25_phase1_features.sql:229: NOTICE:  relation "derived_table" already exists, skipping
CREATE TABLE AS
 count 
-------
     4
(1 row)

SELECT 3
 grade | cnt |      avg_score      
-------+-----+---------------------
 A     |   2 | 93.5000000000000000
 B     |   2 | 87.5000000000000000
 C     |   1 | 78.0000000000000000
(3 rows)

CREATE TABLE
CREATE TABLE
INSERT 0 2
INSERT 0 3
SELECT 2
 name  | total 
-------+-------
 Alice |   300
 Bob   |   150
(2 rows)

SELECT 5
 id |  name   | double_score | high_performer 
----+---------+--------------+----------------
  1 | Alice   |          190 | t
  2 | Bob     |          174 | f
  3 | Charlie |          184 | t
  4 | David   |          156 | f
  5 | Eve     |          176 | f
(5 rows)

psql:tests/25_phase1_features.sql:254: NOTICE:  table "top3" does not exist, skipping
DROP TABLE
SELECT 3
  name   | score 
---------+-------
 Alice   |    95
 Charlie |    92
 Eve     |    88
(3 rows)

DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
psql:tests/25_phase1_features.sql:272: NOTICE:  table "employees_si" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:273: NOTICE:  table "high_earners" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:274: NOTICE:  table "dept_summary" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:275: NOTICE:  table "top_performers" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:276: NOTICE:  table "year_summary" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:277: NOTICE:  table "expr_into" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:278: NOTICE:  table "distinct_depts" does not exist, skipping
DROP TABLE
CREATE TABLE
INSERT 0 6
SELECT 3
 id |  name   | salary 
----+---------+--------
  6 | Frank   |  85000
  3 | Charlie |  80000
  1 | Alice   |  75000
(3 rows)

SELECT 3
    dept     | emp_count |     avg_salary     
-------------+-----------+--------------------
 Engineering |         3 | 80000.000000000000
 Sales       |         2 | 67500.000000000000
 HR          |         1 | 55000.000000000000
(3 rows)

SELECT 2
  name   | salary 
---------+--------
 Frank   |  85000
 Charlie |  80000
(2 rows)

SELECT 3
    dept     
-------------
 Engineering
 HR
 Sales
(3 rows)

SELECT 6
 id |  name   | monthly_salary | above_avg 
----+---------+----------------+-----------
  1 | Alice   |           6250 | t
  2 | Bob     |           5416 | f
  3 | Charlie |           6666 | t
  4 | David   |           4583 | f
  5 | Eve     |           5833 | f
  6 | Frank   |           7083 | t
(6 rows)

SELECT 5
 hire_year | hires | min_sal | max_sal 
-----------+-------+---------+---------
      2017 |     1 |   85000 |   85000
      2018 |     1 |   80000 |   80000
      2019 |     1 |   65000 |   65000
      2020 |     2 |   70000 |   75000
      2021 |     1 |   55000 |   55000
(5 rows)

 high_earner_count 
-------------------
                 3
(1 row)

 dept_count 
------------
          3
(1 row)

 distinct_dept_count 
---------------------
                   3
(1 row)

DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
DROP TABLE
psql:tests/25_phase1_features.sql:329: NOTICE:  table "orders_combined" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:330: NOTICE:  table "customers_combined" does not exist, skipping
DROP TABLE
psql:tests/25_phase1_features.sql:331: NOTICE:  table "order_summary" does not exist, skipping
DROP TABLE
CREATE TABLE
CREATE TABLE
INSERT 0 3
INSERT 0 4
SELECT 3
   name    | region | total_amount 
-----------+--------+--------------
 Acme Corp | North  |         2500
 Gamma LLC | North  |         2000
(2 rows)

UPDATE 2
   name    | region | total_amount 
-----------+--------+--------------
 Acme Corp | North  |         2750
 Beta Inc  | South  |          800
 Gamma LLC | North  |         2200
(3 rows)

DROP TABLE
DROP TABLE
DROP TABLE
                  status                   
-------------------------------------------
 All Phase 1 tests completed successfully!
(1 row)

